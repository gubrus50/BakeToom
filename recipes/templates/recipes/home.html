{% extends "recipes/base.html" %}
{% load recipes_extras %}
{% block content %}
  {% load static %}


  <!-- Search form -->
  <form id="search-form" method="GET" action="{% url 'recipes-home' %}" class="container form-inline my-4 d-flex justify-content-center h-mobile">

    <div class="form-control" style="border-radius: 0; width: 70%; height: 38px">
      <input type="search" name="q" value="{{ query }}" placeholder="Czego dzisiaj pragniesz?" aria-label="Search" style="border: 0; width: 90%">
      <a id="search-filter-btn" href="#filter" class="text-secondary float-right"><i class="fas fa-filter"></i></a>
    </div>
    <button type="submit"class="btn btn-outline-secondary" style="border-radius: 0; height: 38px">Wyszukaj</button>

    <div name="filter-container" style="margin: 20px 10% 0px 10%; display: none">
      <ul class="list-inline">
        <!-- Search by -->
        <li name="search-by" class="list-inline-item">
          <h5 class="h4-mobile">Szukaj według</h5>
          <hr/>
          <ul name="search-by-children">
            <li>
              <input type="checkbox" name="title" value="true" checked />
              nazwy przepisu
            </li>
            <li>
              <input type="checkbox" name="publisher" value="true" checked />
              nazwy wydawcy
            </li>
            <li>
              <input type="checkbox" name="search_by_date" value="PD" disabled />
              daty utworzenia
            </li>
            <li>
              <input type="checkbox" name="search_by_date" value="GD" disabled />
              daty ogólnej
            </li>
            <li>
              <input type="checkbox" name="id" value="1" />
              id przepisu
            </li>
          </ul>
        </li>
        <!-- Upload date -->
        <li name="upload-date" class="list-inline-item">
          <h5 class="h4-mobile">Data przesłania</h5>
          <hr/>
          <ul name="upload-date-children">
            <li>
              <input type="radio" name="search_by_date" value="GUD" checked />
              obojętna
            </li>
            <li>
              <input type="radio" name="search_by_date" value="TUD" />
              dzisiejsza
            </li>
            <li>
              <input type="radio" name="search_by_date" value="TWUD" />
              tego tygodnia
            </li>
            <li>
              <input type="radio" name="search_by_date" value="TMUD" />
              tego miesiąca
            </li>
            <li>
              <input type="radio" name="search_by_date" value="TYUD" />
              tego rocznika
            </li>
          </ul>
        </li>
        <!-- Categories -->
        <li name="categories" class="list-inline-item">
          <h5 class="h4-mobile">Kategorie</h5>
          <hr/>
          <ul name="categories-children">
            <li>
              <input type="checkbox" name="certified" value="true" />
              tylko certyfikowe
            </li>
            <li>
              <input type="radio" name="type" value="general" checked />
              ogólne
            </li>
            <li>
              <input type="radio" name="type" value="wypiek" />
              wypieki
            </li>
            <li>
              <input type="radio" name="type" value="deser" />
              desery
            </li>
            <li>
              <input type="radio" name="type" value="zupa" />
              zupy
            </li>
            <li>
              <input type="radio" name="type" value="inne" />
              inne
            </li>
          </ul>
        </li>
        <!-- Nationality -->
        <li name="nationality" class="list-inline-item">
          <h5 class="h4-mobile">Narodowość</h5>
          <hr/>
          <ul name="nationality-children">
            <li>
              <input type="radio" name="nationality_mode" value="general" checked />
              ogólna
            </li>
            <li>
              <input type="radio" name="nationality_mode" value="international" />
              międzynarodowa
            </li>
            <li>
              <input type="radio" name="nationality_mode" value="specific" />
              specyficzna
            </li>
            <li>
              <select class="selectpicker countrypicker custom-scroll d-none" name="nationality" data-default="PL" data-flag="true"></select>
            </li>
          </ul>
        </li>
      </ul>
    </div>

  </form>


  <!-- Recipes container -->
  <div id="recipes" class="mt-4 mb-5 pt-4 pb-4" style="background-image: url('{% static 'recipes/img/background_notepad.png' %}'); background-size: 15px 15px">
    <center class="container recipe-container">
      {% if recipes %}
        {% for recipe in recipes %}
          <div class="border m-1 btn-light p-2 recipe-container" onclick="$(this).fadeOut(500); setTimeout(function(){window.location='{% url 'recipe-detail' recipe.id %}'}, 500)" style="overflow: auto; border-radius: 5px">
            <article>
              <img class="float-right" width="150px" height="100px" style="border-radius: 5px 5px 5px 75px" src="{{ recipe.image.url }}">
              <h3>{{ recipe.title }}</h3>
              <p>{{ recipe.description }}</p>
              <small class="f16">
                {% if recipe.nationality %}
                  narodowość:
                  <li class="flag {{ recipe.nationality|lower }}"></li>
                {% else %}
                  narodowość: międzynarodowy
                {% endif %},

                {% if recipe.publisher %}
                  wydawca: <a href="{% url 'user-recipes' recipe.publisher.username %}">{{ recipe.publisher }}</a> 
                {% else %}
                  wydawca: null 
                {% endif %},

                {% if recipe.recipe_type %}
                  typ: {{ recipe.recipe_type }}
                {% else %}
                  typ: inne
                {% endif %},

                id_przepisu: {{ recipe.id }}
                {% if recipe.certified %}
                  <img class="float-right" height="25" src="{% static 'recipes/img/icons/flaticon/certificate.svg' %}" />
                {% endif %}
              </small>
            </article>
          </div>
        {% endfor %}
      {% else %}
        <!-- No results msg -->
        <div class="d-flex justify-content-center text-dark p-5 text-center" style="background-color: #f8f9fa">
          <h2>Zero rezultatów</h2>
        </div>
      {% endif %}
    </center>
  </div>


  <!-- Pagination -->
  {% if is_paginated %}
    <center class="pagination justify-content-center">
      <nav id="home-pagination" aria-label="Page navigation example">

        <div>
          <ul class="pagination pagination-circle pg-blue mb-0">
            <!-- To first page -->
            <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
              <a class="page-link" style="border-right: 0" aria-label="First" href="{% if page_obj.has_previous %}?page=1{% else %}#{% endif %}">
                Początek
              </a>
            </li>
            <!-- Direct page choice -->
            {% for num in page_obj.paginator.page_range %}
              {% if page_obj.number == num %}
                <li class="page-item active">
                  <a class="page-link page-link-active-fancy" href="?page={{ num }}">
                    {{ num }}
                  </a>
                </li>
              {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <li class="page-item">
                  <a class="page-link page-link-fancy" href="?page={{ num }}">
                    {{ num }}
                  </a>
                </li>
              {% endif %}
            {% endfor %}
            <!-- To last page -->
            <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
              <a class="page-link" style="border-left: 0" aria-label="Last" href="{% if page_obj.has_next %}?page={{ page_obj.paginator.num_pages }}{% else %}#{% endif %}">
                Koniec
              </a>
            </li>
          </ul>
        </div>

        <div name="page-flip">
          <!-- Previous page action -->
          <a style="border-right: 0" class="{% if not page_obj.has_previous %}disabled{% endif %}" aria-label="Previous" href="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% else %}#{% endif %}">
            <span aria-hidden="true">&laquo;</span>
          </a>
          <!-- Result counter -->
          <a style="width: 60%; border-left: 0; border-right: 0; color: #6c757d; cursor: default">
            <span id="search-result-counter">{{ page_obj.paginator.count }}</span>
              rezultatów
          </a>
          <!-- Next page action -->
          <a style="border-left: 0" class="{% if not page_obj.has_next %}disabled{% endif %}" aria-label="Next" href="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% else %}#{% endif %}">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </div>

      </nav>
    </center>
  {% endif %}
  <!-- End of Pagination -->


{% endblock content %}
